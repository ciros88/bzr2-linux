# Maintainer: Ciro Scognamiglio <ciro.scognamiglio88 (at) gmail.com>
# Contributor: Ciro Scognamiglio <ciro.scognamiglio88 (at) gmail.com>

pkgname='bzr-player'
_pkgname='BZR Player'
_pkgname_zip='BZR-Player'
pkgver='2.0.68'
pkgrel='1'
pkgdesc='Audio player supporting a wide types of multi-platform exotic file formats'
arch=('i686' 'x86_64')
url="http://bzrplayer.blazer.nu"
license=('GPL3') #TODO
depends=('wine' 'winetricks')
makedepends=('gendesk' 'unzip')
optdepends=("xorg-xrdb") #TODO
options=(!strip)
mimes=x-bzr-player.xml
source=("$_pkgname_zip-$pkgver.zip::http://bzrplayer.blazer.nu/getFile.php?id=${pkgver}"
        "https://raw.githubusercontent.com/ciros88/bzr2-linux-installer/master/$mimes"
        "https://raw.githubusercontent.com/ciros88/bzr2-linux-installer/master/bzr2_installer.sh")

sha256sums=('02d2dd2f43a281ecb846b8a8f6b515bd18134b2ef26abb311211391896afcc22'
            'SKIP'
            'SKIP')

# https://wiki.archlinux.org/title/Creating_packages
# https://wiki.archlinux.org/title/PKGBUILD
# https://wiki.archlinux.org/title/Wine_package_guidelines
# https://wiki.archlinux.org/title/desktop_entries#gendesk

prepare()
{
  #cd "$_pkgname_zip-$pkgver"

  gendesk -n -f --pkgname "$pkgname" --pkgdesc "$pkgdesc" \
    --name=$_pkgname \
    --genericname='Audio player' \
    --exec '' \
    --icon '' \
    --categories 'AudioVideo;Audio;Player;Music' \
    --mimetype=''
}

package()
{
  #cd "$_pkgname_zip-$pkgver"
  install -Dm644 "BZRPlayer.exe" "$pkgdir/usr/share/$pkgname" #TODO
  install -Dm644 "$mimes" "$pkgdir/usr/share/mime/packages/$mimes"
  install -Dm644 "$pkgname.desktop" "$pkgdir/usr/share/applications/$pkgname.desktop"
}